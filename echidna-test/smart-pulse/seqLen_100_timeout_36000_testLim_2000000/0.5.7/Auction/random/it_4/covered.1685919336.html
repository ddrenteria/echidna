<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/home/zhaeres/Desktop/Tesis/ours/echidna/smart-pulse/0.5.7/Auction.sol</b>
<code>
  1 |     | <span class='neutral'>pragma solidity ^0.5.0;</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>// bugs:</span>
  4 |     | <span class='neutral'>// 1. Auction can never end</span>
  5 |     | <span class='neutral'>// 2. highest bidder can never be refunded their highest bid</span>
  6 |     | <span class='neutral'></span>
  7 | *   | <span class='executed'>contract Auction {</span>
  8 |     | <span class='neutral'>    uint auctionStart;</span>
  9 |     | <span class='neutral'>    uint biddingTime;</span>
 10 |     | <span class='neutral'>    address payable beneficiary;</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='unexecuted'>    bool ended = false;</span>
 13 |     | <span class='unexecuted'>    address payable highestBidder = address(0);</span>
 14 |     | <span class='unexecuted'>    uint highestBid = 0;</span>
 15 |     | <span class='neutral'>    mapping(address =&gt; uint) pendingReturns;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>    constructor() public {</span>
 18 |     | <span class='unexecuted'>        auctionStart = 4400000;</span>
 19 |     | <span class='unexecuted'>        biddingTime = 500000;</span>
 20 |     | <span class='unexecuted'>        beneficiary = address(0x10000);</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'></span>
 23 | *   | <span class='executed'>    function Bid() public payable {</span>
 24 | *   | <span class='executed'>        uint end = auctionStart + biddingTime;</span>
 25 | *   | <span class='executed'>        if(end &lt; block.number || ended) {</span>
 26 | *r  | <span class='executed'>            revert();</span>
 27 |     | <span class='neutral'>        }</span>
 28 |     | <span class='neutral'>        else {</span>
 29 | *   | <span class='executed'>            if(msg.value &lt;= highestBid) {</span>
 30 | *r  | <span class='executed'>                revert();</span>
 31 |     | <span class='neutral'>            }</span>
 32 |     | <span class='neutral'>            else {</span>
 33 | *   | <span class='executed'>                pendingReturns[highestBidder] += highestBid; </span>
 34 | *   | <span class='executed'>                highestBidder = msg.sender;</span>
 35 | *   | <span class='executed'>                highestBid = msg.value;</span>
 36 |     | <span class='neutral'>            }</span>
 37 |     | <span class='neutral'>        }</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 | *   | <span class='executed'>    function Withdraw() public {</span>
 41 | *   | <span class='executed'>        if(pendingReturns[msg.sender] != 0) {</span>
 42 | *   | <span class='executed'>            uint pr = pendingReturns[msg.sender];</span>
 43 | *   | <span class='executed'>            pendingReturns[msg.sender] = 0;</span>
 44 | *   | <span class='executed'>            msg.sender.transfer(pr);</span>
 45 |     | <span class='neutral'>        }</span>
 46 |     | <span class='neutral'>        else {</span>
 47 | *r  | <span class='executed'>            revert();</span>
 48 |     | <span class='neutral'>        }</span>
 49 |     | <span class='neutral'>    }</span>
 50 |     | <span class='neutral'></span>
 51 | *   | <span class='executed'>    function AuctionEnd() public {</span>
 52 | *   | <span class='executed'>        uint end = auctionStart + biddingTime;</span>
 53 |     | <span class='neutral'></span>
 54 |     | <span class='neutral'>        //!ended is a bug</span>
 55 | *   | <span class='executed'>        if(block.number &lt;= end || !ended) {</span>
 56 | *r  | <span class='executed'>            revert();</span>
 57 |     | <span class='neutral'>        }</span>
 58 |     | <span class='neutral'>        else {</span>
 59 |     | <span class='unexecuted'>            ended = true;</span>
 60 |     | <span class='unexecuted'>            beneficiary.transfer(highestBid);</span>
 61 |     | <span class='neutral'>        }</span>
 62 |     | <span class='neutral'>    }</span>
 63 |     | <span class='neutral'>}</span>
 64 |     | <span class='neutral'></span>

</code>
<br />

